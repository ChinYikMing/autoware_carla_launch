# autoware_carla_launch

The package includes launch file to run Autoware, Carla agent, and bridge (zenoh-bridge-dds + carla_autoware_zenoh_bridge).

# System Requirements

* Ubuntu 20.04
* Autoware.universe galactic version
* Carla 0.9.13

# Prerequisite

* Install Carla

## Running in native host

* Install Autoware

## Running in docker

```shell
sudo apt install docker.io python3-rocker
./run-docker.sh
```

# Build

* Clean the files

```shell
make clean
```

* Download necessary code & data

```shell
source env.sh
make prepare
```

* Build

```shell
# Source Autoware first before build
make build
```

# Usage

## Carla with Autoware

1. Run Carla simulator first

```shell
./CarlaUE4.sh -quality-level=Epic -world-port=2000 -RenderOffScreen
```

2. Run Autoware with Carla
 
```shell
source env.sh
ros2 launch autoware_carla_launch autoware_carla.launch.xml
```

## Manual control vehicle in Carla

1. Run Carla simulator first

```shell
./CarlaUE4.sh -quality-level=Epic -world-port=2000 -RenderOffScreen
```

2. Run Autoware with Carla

```shell
source env.sh
ros2 launch autoware_carla_launch manual_control.launch.xml
```

3. Run manual control package

```shell
source env.sh
ros2 run autoware_manual_control keyboard_control
```

# Known Issues

* IMU issue: The bridge can't publish corrent IMU data to Carla.
  - I think this is why sometimes the localization is not stable...
* Upgrade Autoware: Porting the bridge to ROS 2 Humble.
* Generate the map: Now we're using the maps generated by Hatem.
* Long time to launch: It takes a long time to launch bridge and Autoware.
* Running with docker container is really lag...
